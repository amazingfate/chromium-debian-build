From 2b2bbdbd3f686d7f9dfa0ab8da2bbf8c074bec9a Mon Sep 17 00:00:00 2001
From: Jianfeng Liu <liujianfeng1994@gmail.com>
Date: Fri, 29 Nov 2024 17:03:52 +0800
Subject: [PATCH 5/5] media/gpu/chromeos: Use V4L2VideoDecoder for linux

---
 media/gpu/chromeos/video_decoder_pipeline.cc | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/media/gpu/chromeos/video_decoder_pipeline.cc b/media/gpu/chromeos/video_decoder_pipeline.cc
index c00c7b5dc5..593d0053b8 100644
--- a/media/gpu/chromeos/video_decoder_pipeline.cc
+++ b/media/gpu/chromeos/video_decoder_pipeline.cc
@@ -231,8 +231,12 @@ std::unique_ptr<VideoDecoder> VideoDecoderPipeline::Create(
     create_decoder_function_cb = base::BindOnce(&VaapiVideoDecoder::Create);
 #elif BUILDFLAG(USE_V4L2_CODEC)
     if (IsV4L2DecoderStateful()) {
+#if BUILDFLAG(IS_LINUX)
+      create_decoder_function_cb = base::BindOnce(&V4L2VideoDecoder::Create);
+#else
       create_decoder_function_cb =
           base::BindOnce(&V4L2StatefulVideoDecoder::Create);
+#endif
     } else {
       create_decoder_function_cb = base::BindOnce(&V4L2VideoDecoder::Create);
     }
-- 
2.43.0

